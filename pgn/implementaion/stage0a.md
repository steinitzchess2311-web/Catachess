# Stage 0A - 约束与工作方法（必须先做）

## 约束（必须写在每个 stage 文档开头）
- [ ] 每完成一项任务，必须勾选对应 checkbox。
- [ ] 如果遇到阻塞或不确定，必须直接写明问题，不允许猜测后勾选。
- [ ] 禁止“先勾选后补做”。
- [ ] 禁止谎报进度；我会抽查对比代码。

---

## 本 Stage 目标
建立统一工作方式和执行准则，确保迁移过程可追踪、可回滚、可验收。

---

## 分计划（Checklist）

### A. 统一工程约束
- [ ] 确认不改 DB 结构（`variations`/`move_annotations` 不新增字段）。
- [ ] 确认 R2 `chapters/{chapter_id}.pgn` 不改 key。
- [ ] 确认新代码只新增目录，不混写旧目录。

### B. 任务推进规则
- [ ] 每次改动必须注明影响范围（文件清单 + 理由）。
- [ ] 每次改动必须注明是否可回滚以及回滚方式。
- [ ] 每次改动必须注明是否影响前端。

### C. 回滚策略模板
- [ ] 写清楚“回滚按钮”在哪里：
  - [ ] PGN 生成切换回 `modules/workspace/pgn/serializer/*`
  - [ ] API `/show` 失败时前端回退 mainline 接口
  - [ ] fen_index 不可用时禁用分析任务

### D. 风险报告规范
- [ ] 任何未完成或有疑问的项必须写 `BLOCKED: ...`。
- [ ] 不允许以“应该没问题”作为完成理由。

---

## 输出物（本阶段交付）
- 明确的约束/回滚规则
- 统一的工作报告格式

